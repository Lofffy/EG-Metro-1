<!DOCTYPE html>
<html>
  <head>
    <title>EG-Metro</title>
    <link rel='stylesheet' href='/styles/bootstrap.min.css' />
    <link rel='stylesheet' href='/styles/style.css' />
    <script src="/js/jquery-2.2.0.min.js" type="text/javascript"></script>
    <script src="/js/bootstrap.min.js" type="text/javascript"></script>
  </head><style>
   .navbar-container {
        background-color: #333;
        color: #fff;
        padding: 0px 20px;
        font-family: Arial, sans-serif;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
    }

    .navbar {
        list-style-type: none;
        padding: 0;
        margin: 0;
    }

    .navbar li {
        display: inline-block;
        margin-right: 10px;
    }

    .navbar li a {
        color: #fff;
        text-decoration: none;
        padding: 5px 10px;
    }

    .navbar li a:hover {
        background-color: #555;
        border-radius: 5px;
    }
body {
        margin-top: 40px; /* Adjust the margin-top value according to your needs */
      }
</style>
<div class="navbar-container">
    <ul class="navbar">
        <li><a href="/manage/stations">Manage Stations</a></li>
        <li><a class="active" href="/manage/routes">Manage Route</a></li>
        <li><a href="/manage/requests/refunds">Manage Refunds</a></li>
        <li><a href="/manage/requests/seniors">Manage Seniors</a></li>
        <li><a href="/manage/zones">Manage Zones</a></li>
        <li><a href="/">Logout</a></li>
    </ul>
</div>
  <body>
    <div>
      
      <br/>
     
      <table class="table">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">From Station </th>
            <th scope="col">To Station  </th>
            <th scope="col">Name</th>
            <th scope="col">Actions</th> <!-- Added column for actions -->
          </tr>
        </thead>
        <tbody>
          {{#routes}}
          <tr>
            <td>{{id}}</td>
            <td>{{s2Name}}</td>
            <td>{{s1Name}}</td>
            <td>
              <span class="route-name">{{routename}}</span>
              <input type="text" class="form-control route-name-input" value="{{routename}}" style="display: none;">
            </td>
            <td>
              <button class="btn btn-danger btnDeleteRoute" data-route-id="{{id}}">Delete</button>
              <button class="btn btn-primary btnModifyRoute" data-route-id="{{id}}">Modify</button>
              <button class="btn btn-success btnSaveRoute" data-route-id="{{id}}" style="display: none;">Save</button>
              <button class="btn btn-secondary btnCancelEdit" data-route-id="{{id}}" style="display: none;">Cancel</button>
            </td>
          </tr> 
          {{/routes}}
        </tbody>
      </table>
  
<button class="btn btn-primary" onclick="window.location.href = '/manage/routes/create';"> Create routes</button>

    <script>


      // Add event listener for Delete Route button
      $(document).on("click", ".btnDeleteRoute", function() {
        var routeId = $(this).data("route-id");
        $.ajax({
    url: "/api/v1/route/"+routeId,
    type: "DELETE",
    success: function(response) {
      // Handle the success response here
      alert("Route removed successfully:" + response);
      location.reload()
    },
        error: function(xhr, status, error) {
      // Handle the error response here
      console.log("Error occurred:", error);
      // You can display an error message to the user or perform any necessary actions
        }
     }); 
      });

// Add event listener for Modify Route button
$(document).on("click", ".btnModifyRoute", function() {
  var routeId = $(this).data("route-id");

  // Retrieve the row elements related to the clicked modify button
  var $row = $(this).closest("tr");
  var $routeName = $row.find(".route-name");
  var $routeNameInput = $row.find(".route-name-input");
  var $btnSave = $row.find(".btnSaveRoute");
  var $btnCancel = $row.find(".btnCancelEdit");

  // Toggle the visibility of elements to enable editing
  $routeName.hide();
  $routeNameInput.val($routeName.text()).show();
  $btnSave.show();
  $btnCancel.show();

  // Add event listener for Cancel button to revert changes
  $btnCancel.on("click", function() {
    $routeNameInput.val($routeName.text());
    $routeName.show();
    $routeNameInput.hide();
    $btnSave.hide();
    $btnCancel.hide();
  });

  // Add event listener for Save button to update the route
  $btnSave.on("click", function() {
    var newRouteName = $routeNameInput.val();

    // Create the data object to send in the AJAX request
    var data = {
      routeName: newRouteName
    };

    $.ajax({
      url: "/api/v1/route/" + routeId,
      type: "PUT",
      data: data,
      success: function(response) {
        // Handle the success response here
        console.log("Route modified successfully:", response);
        // Update the UI with the new route name
        $routeName.text(newRouteName);
        $routeName.show();
        $routeNameInput.hide();
        $btnSave.hide();
        $btnCancel.hide();
      },
      error: function(xhr, status, error) {
        // Handle the error response here
        console.log("Error occurred:", error);
        // You can display an error message to the user or perform any necessary actions
      }
    });
  });
});
    </script>
  </body>
</html>
