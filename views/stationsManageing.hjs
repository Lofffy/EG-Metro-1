<!DOCTYPE html>
<html>
  <head>
    <title>EG-Metro</title>
    <link rel='stylesheet' href='/styles/bootstrap.min.css' />
    <link rel='stylesheet' href='/styles/style.css' />
    <script src="/js/jquery-2.2.0.min.js" type="text/javascript"></script>
    <script src="/js/bootstrap.min.js" type="text/javascript"></script>
  </head>
  <style>
   .navbar-container {
        background-color: #333;
        color: #fff;
        padding: 0px 20px;
        font-family: Arial, sans-serif;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
    }

    .navbar {
        list-style-type: none;
        padding: 0;
        margin: 0;
    }

    .navbar li {
        display: inline-block;
        margin-right: 10px;
    }

    .navbar li a {
        color: #fff;
        text-decoration: none;
        padding: 5px 10px;
    }

    .navbar li a:hover {
        background-color: #555;
        border-radius: 5px;
    }
body {
        margin-top: 40px; /* Adjust the margin-top value according to your needs */
      }
</style>
<div class="navbar-container">
    <ul class="navbar">
        <li><a href="/manage/stations">Manage_Stations</a></li>
        <li><a href="/manage/routes">Manage_Route</a></li>
        <li><a href="/manage/requests/refunds">Manage_Refunds</a></li>
        <li><a href="/manage/requests/seniors">Manage_Seniors</a></li>
        <li><a href="/manage/zones">Manage_Zones</a></li>
        <li><a href="/">Logout</a></li>
    </ul>
</div>
  <body>
    <div>
      
      <br/>
     
      <table class="table">
  <thead>
    <tr>
      <th scope="col">id</th>
      <th scope="col">Name</th>
      <th scope="col">Type</th>
      <th scope="col">Position</th>
      <th scope="col">status</th>
      <th scope="col">Actions</th> <!-- Added column for actions -->
    </tr>
  </thead>
  <tbody>
    {{#stations}}
            <tr>
              <td>{{id}}</td>
              <td>
                <span class="station-name">{{stationname}}</span>
                <input type="text" class="form-control station-name-input" value="{{stationname}}" style="display: none;">
              </td>
              <td>
                <span class="station-type">{{stationtype}}</span>
                 <select id="stationType" name="stationType" class="station-type-input" style="display: none;">
                <option value="0">Normal</option>
                <option value="1">Transfer</option>
                </select>
              </td>
              <td>
                <span class="station-position">{{stationposition}}</span>
              </td>
              <td>
                <span class="station-status">{{stationstatus}}</span>
                <input type="text" class="form-control station-status-input" value="{{stationstatus}}" style="display: none;">
              </td>
              <td>
                <button class="btn btn-danger btnDeleteStation" data-station-id="{{id}}">Delete</button>
                <button class="btn btn-primary btnModifyStation" data-station-id="{{id}}">Modify</button>
                <button class="btn btn-success btnSaveStation" data-station-id="{{id}}" style="display: none;">Save</button>
                <button class="btn btn-secondary btnCancelEdit" data-station-id="{{id}}" style="display: none;">Cancel</button>
              </td>
            </tr> 
    {{/stations}}
  </tbody>
</table>
        </thead>
      </table>
    </div>
     {{#isAdmin}}
      <div style="position:center; ">
        <button id="btnAddStation" class="btn btn-primary" style="position:center; ">Add station</button>
        <br />
        <div id="addStationForm" style="display: none;">
          <label for="stationName">Station Name:</label>
          <input type="text" id="stationName" name="stationName" class="form-control" />
          <br />
          <label for="stationType">Station Type:</label>
          <select id="stationType" name="stationType" class="form-control">
          <option value="0">Normal</option>
          <option value="1">Transfer</option>
          </select>
          <br />
          <label for="stationStatus">Station Status:</label>
          <input type="text" id="stationStatus" name="stationStatus" class="form-control" />
          <br />
          <button id="btnSaveStation" class="btn btn-primary">Save</button>
          <button id="btnCancel" class="btn btn-default">Cancel</button>
        </div>
      </div>
      {{/isAdmin}}
    <script>
      $(document).ready(function() {
        $("#btnAddStation").click(function() {
          $("#addStationForm").toggle();
        });

        $("#btnCancel").click(function() {
          $("#addStationForm").toggle();
        });

        $("#btnSaveStation").click(function() {
          const stationName = $("#stationName").val();
          const stationType = $("#stationType").val();
          const stationStatus = $("#stationStatus").val();

          // Perform an AJAX request to save the new station data
          $.ajax({
            url: "/api/v1/station",
            type: "POST",
            data: {
              stationName: stationName,
              stationType: stationType,
              stationStatus: stationStatus
            },
            success: function(response) {
              // Handle success response
              location.reload()
              console.log(response);
            },
            error: function(error) {
              // Handle error response
              console.log(error);
            }
          });
        });
      });

      $(document).ready(function() {
  // Add event listener for delete buttons
  $(document).on("click", ".btnDeleteStation", function() {
    var stationId = $(this).data("station-id");

    // Perform an AJAX request to delete the station
    $.ajax({
      url: "/api/v1/station/" + stationId,
      type: "DELETE",
      success: function(response) {
        // Handle success response
        alert(response);
        location.reload()

      },
      error: function(error) {
        // Handle error response
        console.log(error);
      }
    });
  });
});
    $(document).ready(function() {
        // Add event listener for modify buttons
        $(document).on("click", ".btnModifyStation", function() {
          var stationId = $(this).data("station-id");
          var stationRow = $(this).closest("tr");
    
          // Toggle display of station fields and input boxes
          stationRow.find(".station-name").toggle();
          stationRow.find(".station-name-input").toggle();
          stationRow.find(".station-type").toggle();
          stationRow.find(".station-type-input").toggle();
          stationRow.find(".station-position").toggle();
          stationRow.find(".station-status").toggle();
          stationRow.find(".station-status-input").toggle();
    
          // Toggle display of buttons
          stationRow.find(".btnModifyStation").toggle();
          stationRow.find(".btnSaveStation").toggle();
          stationRow.find(".btnCancelEdit").toggle();
        });
    
        // Add event listener for cancel buttons
        $(document).on("click", ".btnCancelEdit", function() {
          var stationRow = $(this).closest("tr");
    
          // Toggle display of station fields and input boxes
          stationRow.find(".station-name-input").hide();
          stationRow.find(".station-name").show();
          stationRow.find(".station-type-input").hide();
          stationRow.find(".station-type").show();
          stationRow.find(".station-position").show();
          stationRow.find(".station-status-input").hide();
          stationRow.find(".station-status").show();
    
          // Toggle display of buttons
          stationRow.find(".btnModifyStation").show();
          stationRow.find(".btnSaveStation").hide();
          stationRow.find(".btnCancelEdit").hide();
        });
    
        // Add event listener for save buttons
        $(document).on("click", ".btnSaveStation", function() {
          var stationId = $(this).data("station-id");
          var stationRow = $(this).closest("tr");
          var stationName = stationRow.find(".station-name-input").val();
          var stationType = stationRow.find(".station-type-input").val();
          var stationStatus = stationRow.find(".station-status-input").val();
    
          // Perform an AJAX request to update the station
          $.ajax({
            url: "/api/v1/station/" + stationId,
            type: "PUT",
            data: JSON.stringify({ 
              stationName: stationName,
              stationType: stationType,
              stationStatus: stationStatus
            }),
            contentType: "application/json",
            success: function(response) {
              // Handle success response
              console.log(response);
              if(stationType == 0)
                stationType = "normal"
              else if (stationType == 1)
                stationType = "transfer"
              // Update the station fields in the UI
              stationRow.find(".station-name").text(stationName);
              stationRow.find(".station-type").text(stationType);
              stationRow.find(".station-status").text(stationStatus);
    
              // Toggle display of station fields and input boxes
              stationRow.find(".station-name-input").hide();
              stationRow.find(".station-name").show();
              stationRow.find(".station-type-input").hide();
              stationRow.find(".station-type").show();
              stationRow.find(".station-position").show();
              stationRow.find(".station-status-input").hide();
              stationRow.find(".station-status").show();
    
              // Toggle display of buttons
              stationRow.find(".btnModifyStation").show();
              stationRow.find(".btnSaveStation").hide();
              stationRow.find(".btnCancelEdit").hide();
            },
            error: function(xhr, textStatus, errorThrown) {
              // Handle error response
              console.log(xhr.responseText);
            }
          });
        });
    });
    </script>
  </body>
</html>
